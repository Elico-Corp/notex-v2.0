## installation: Ubuntu 12.04 LTS

apt-get -y update
apt-get -y upgrade

## locale: en_US.UTF-8

locale-gen en_US.UTF-8
LANG=en_US.UTF-8 LANGUAGE=en_US.UTF-8 update-locale

## tools: build-essential, nano, wget, curl, git

apt-get -y install build-essential git
apt-get -y install zip unzip
apt-get -y install wget curl
apt-get -y install nano sudo

## java: 7u40

wget jdk-7u40-linux-x64.tar.gz https://db.tt/9z8ZYIJU
tar -xvf *-linux-x64.tar.gz
mkdir -p /usr/lib/jvm
mv ./jdk1.7.0_40 /usr/lib/jvm/jdk1.7.0

update-alternatives --install "/usr/bin/java" "java" "/usr/lib/jvm/jdk1.7.0/bin/java" 1
update-alternatives --install "/usr/bin/javac" "javac" "/usr/lib/jvm/jdk1.7.0/bin/javac" 1
update-alternatives --install "/usr/bin/javaws" "javaws" "/usr/lib/jvm/jdk1.7.0/bin/javaws" 1

chmod a+x /usr/bin/java
chmod a+x /usr/bin/javac
chmod a+x /usr/bin/javaws
chown -R root:root /usr/lib/jvm/jdk1.7.0

## ruby: 1.8.7

apt-get -y install ruby

## sencha command: 3.0.2.288

wget -O 3.0.2.288-linux-x64.run.zip https://db.tt/KEVpOKtG
unzip *.zip && chmod +x *.run
mkdir -p /opt/Sencha/Cmd/
mv *.run /opt/Sencha/Cmd/
cd /opt/Sencha/Cmd
./3.0.2.288-linux-x64.run

## memcached

apt-get -y install memcached
apt-get -y install libmemcached-dev

## redis: www.dotdeb.org

echo "deb http://packages.dotdeb.org squeeze all" >> \
/etc/apt/sources.list.d/dotdeb.org.list
echo "deb-src http://packages.dotdeb.org squeeze all" >> \
/etc/apt/sources.list.d/dotdeb.org.list
wget -q -O - http://www.dotdeb.org/dotdeb.gpg | \
apt-key add -

apt-get update
apt-get -y install redis-server

## postgres: apt.postgresql.org

echo "deb http://apt.postgresql.org/pub/repos/apt/ precise-pgdg main" >> \
/etc/apt/sources.list.d/pgdg.list
wget --quiet -O - http://apt.postgresql.org/pub/repos/apt/ACCC4CF8.asc | \
apt-key add -

apt-get update
apt-get -y install libpq-dev
apt-get -y install postgresql-9.3

## python: pip, virtualenv

apt-get install python2.7-dev python-setuptools
easy_install pip
pip install virtualenv

## notex.ch: git

git clone https://github.com/hsk81/notex /srv/notex.git 
cd /srv/notex.git
git submodule update --init
git checkout v2.1.3
git checkout -b tag-v2.1.3

## notex.ch: postgres

su postgres
psql -f webed/config/pg.sql
psql -f webed/config/test.sql
psql -f webed/config/production.sql ## create!
exit

## notex.ch: setup

./setup.sh
source bin/activate
./setup.py install
pip uninstall Flask-Admin
./setup.py install

## notex.ch: run (debug)

export WEBED_SETTINGS=/srv/notex.git/webed/config/production.py ## create!
cd /srv/notex.git && ./webed.py run -d

